package org.otherobjects.cms.views;import java.io.PrintWriter;import java.util.List;import java.util.Map;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import org.json.JSONArray;import org.json.JSONObject;import org.springframework.web.servlet.View;public class JsonView implements View{    @SuppressWarnings("unchecked")    public void render(Map map, HttpServletRequest request, HttpServletResponse response) throws Exception    {        PrintWriter writer = response.getWriter();        if (map.get("data") instanceof List)        {            JSONArray json = new JSONArray();            for(Map m : (List<Map>)map.get("data") )            {                      json.put(new JSONObject(m));            }            writer.write(json.toString());        }        else        {            JSONObject jsonObject = new JSONObject(map);            writer.write(jsonObject.toString());        }    }    public String getContentType()    {        return "application/json";    }}