package org.otherobjects.cms.controllers;import java.io.IOException;import javax.servlet.ServletException;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import javax.servlet.http.HttpSession;import org.otherobjects.cms.dao.DynaNodeDao;import org.otherobjects.cms.dao.UserDao;import org.springframework.web.servlet.ModelAndView;import org.springframework.web.servlet.mvc.Controller;public class SiteController implements Controller{    //private final Logger logger = LoggerFactory.getLogger(SiteController.class);    private DynaNodeDao dynaNodeDao;    private UserDao userDao;    public ModelAndView handleRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException    {        String path = request.getPathInfo();        // Update session counter        HttpSession session = request.getSession();        Integer counter = (Integer) session.getAttribute("counter");        if(counter == null)            counter = 0;                session.setAttribute("counter", ++counter);                if (path.length() > 0 && path.endsWith("/"))            path = path.substring(0, path.length() - 1);        //logger.info("SpringappController: " + path);        //        Resource resource = (Resource) getWorkbenchService().getResource("/site" + path);        //        String type = resource.getType().toLowerCase();        //                //        Resource template = (Resource) getWorkbenchService().getResource("/designer/templates/" + type + ".html");        //        Resource layout = (Resource) template.getData().get("layout");        //                ModelAndView view = new ModelAndView("/templates/pages/index.html");        view.addObject("counter", counter);        view.addObject("nodeDao", dynaNodeDao);        view.addObject("userDao", userDao);        //        view.addObject("resourceObject", getWorkbenchService().getResource("/site" + path));        //        view.addObject("folders", getWorkbenchService().getAllFolders("/site"));        //        view.addObject("templateName", template.getName());        return view;    }    public UserDao getUserDao()    {        return userDao;    }    public void setUserDao(UserDao userDao)    {        this.userDao = userDao;    }    public DynaNodeDao getDynaNodeDao()    {        return dynaNodeDao;    }    public void setDynaNodeDao(DynaNodeDao dynaNodeDao)    {        this.dynaNodeDao = dynaNodeDao;    }}