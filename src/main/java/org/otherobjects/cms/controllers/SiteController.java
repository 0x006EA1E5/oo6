package org.otherobjects.cms.controllers;import java.io.IOException;import javax.servlet.ServletException;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import org.otherobjects.cms.dao.UserDao;import org.otherobjects.cms.jcr.CmsNodeService;import org.otherobjects.cms.model.CmsNode;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.web.servlet.ModelAndView;import org.springframework.web.servlet.mvc.Controller;public class SiteController implements Controller{    private final Logger logger = LoggerFactory.getLogger(SiteController.class);        private CmsNodeService cmsNodeService;    private UserDao userDao;        public ModelAndView handleRequest(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException    {        String path = request.getPathInfo();                if(path.length() > 0 && path.endsWith("/")) path = path.substring(0, path.length()-1);        //logger.info("SpringappController: " + path);//        Resource resource = (Resource) getWorkbenchService().getResource("/site" + path);//        String type = resource.getType().toLowerCase();//        //        Resource template = (Resource) getWorkbenchService().getResource("/designer/templates/" + type + ".html");//        Resource layout = (Resource) template.getData().get("layout");//                ModelAndView view = new ModelAndView("/index.html");        view.addObject("nodeDao", cmsNodeService);        view.addObject("userDao", userDao);//        view.addObject("resourceObject", getWorkbenchService().getResource("/site" + path));//        view.addObject("folders", getWorkbenchService().getAllFolders("/site"));//        view.addObject("templateName", template.getName());        return view;    }    public CmsNodeService getCmsNodeService()    {        return cmsNodeService;    }    public void setCmsNodeService(CmsNodeService cmsNodeService)    {        this.cmsNodeService = cmsNodeService;    }    public UserDao getUserDao()    {        return userDao;    }    public void setUserDao(UserDao userDao)    {        this.userDao = userDao;    }}